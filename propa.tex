\documentclass[12pt, a4paper]{article}

\usepackage[spanish]{babel}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{mathtools}
\usepackage{multicol}
% \usepackage{esvect}

\usepackage{physics}
\DeclareDocumentCommand\vnabla{}{\nabla}


\usepackage{parskip}
\usepackage{esint}
% \usepackage{geometry}
\usepackage{xcolor}

% Vectors
% \renewcommand{\vec}[1]{\mathbf{#1}}
\makeatletter
\newcommand{\vv}[2][]{
    \@ifempty{#1}{\vec{#2}}{\vec{#2}_{#1}}
}
\makeatother

\title{Apuntes de Propagación de Ondas}
\author{Javier Rodrigo López}
\date{\today}
 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}
% \renewcommand{\arraystretch}{1.2}
\maketitle

% Table of contents
\tableofcontents

\newpage
\section*{Introducción}

El primer parcial incluye los temas 1 a 4. El segundo parcial incluye los temas 5 a 9. Se debe obtener una nota mínima de 3 en cada uno y la media debe ser mayor o igual a 5. Ambos parciales ponderan un 50\% en la nota final. Se puede optar a evaluación final en lugar del segundo parcial.

\subsection*{Fechas de examen}

\begin{description}
    \item [Primer parcial] 13 de noviembre
    \item [Segundo parcial o global] 20 de enero
\end{description}

\subsection*{Ejercicios propuestos}
Hay que hacer los ejercicios propuestos antes de que el profesor los resuelva en clase. Los que serán resueltos en clase son los siguientes:
\begin{multicols}{5}
    \begin{itemize}
        \item 1.3
        \item 1.6
        \item 2.1
        \item 2.4
        \item 3.5
        \item 4.3
        \item 4.5
        \item 5.3
        \item 5.7
        \item 6.3
        \item 6.7
        \item 7.3
        \item 7.5
        \item 8.2
        \item 8.4
        \item 9.2
        \item 9.10
    \end{itemize}
\end{multicols}

\subsection*{Tareas pendientes}

\begin{itemize}
    \item Relación entre vectores unitarios \textbf{sin mezclar coordenadas}. Es decir, un ejemplo:
    \[ \frac{x}{\sqrt{x^2 + y^2}} \qquad \text{en lugar de} \qquad \cos \varphi \]
\end{itemize}

\newpage
\section{Herramientas: operadores vectoriales}

Una \textbf{función de onda} es una función en el espacio y el tiempo que describe el comportamiento de una onda.

El sistema de referencia será siempre un triedro orientado a derechas, de modo que se cumpla:
\begin{equation} \label{eq:triedro}
    \begin{split}
        \vv[x]{u} + \vv[1]{x} \cp \vv[y]{u} = + \vv[z]{u} \\
        \vv[y]{u} \cp \vv[x]{u} = - \vv[z]{u} 
    \end{split}
\end{equation}

Las \textbf{coordenadas} de un punto representan la posición de ese punto en el espacio.

Una \textbf{superficie coordenada} es una superficie que se define por una ecuación de la forma $f(x, y, z) = \text{cte.}$

El vector posición de un punto $P$ en el espacio se denota como $\vv{r}$, y se puede expresar en función de las coordenadas del punto (diferente en cada sistema de coordenadas).

\subsection{Sistemas de coordenadas}
\subsubsection{Coordenadas cartesianas}

Recomendables para problemas con \textbf{simetría plana}. Los valores que pueden tomar las coordenadas son:
\begin{equation}
    \begin{aligned}
        x \in (-\infty, +\infty) \\
        y \in (-\infty, +\infty) \\
        z \in (-\infty, +\infty)
    \end{aligned}
\end{equation}

\begin{itemize}
    \item La coordenada $x$ es la distancia del punto a la superficie $yz$.
    \item La coordenada $y$ es la distancia del punto a la superficie $xz$.
    \item La coordenada $z$ es la distancia del punto a la superficie $xy$.
\end{itemize}

Cualquier vector puede expresarse como combinación lineal de los vectores unitarios.En cualquier sistema de coordenadas, los vectores unitarios tienen módulo unidad y son perpendiculares entre sí. En este sistema, los vectores unitarios son: $\vv[x]{u}, \vv[y]{u}, \vv[z]{u}$. 

El vector $\vv[x]{u}$ es perpendicular a la superficie coordenada $x = \text{cte.}$, y apunta en la dirección creciente de $x$. Análogamente para $\vv[y]{u}$ y $\vv[z]{u}$. Los vectores unitarios cartesianos mantienen la orientación relativa en todos los puntos del espacio.

El vector posición $\vv{r}$ se puede expresar como:
\begin{equation}
    \vv{r} = x \vv[x]{u} + y \vv[y]{u} + z \vv[z]{u}
\end{equation}

\subsubsection{Coordenadas cilíndricas}

Recomendables para problemas con \textbf{simetría cilíndrica}. Los valores que pueden tomar las coordenadas son:
\begin{equation}
    \begin{aligned}
        \rho &\in [0, +\infty) \\
        \varphi &\in [0, 2\pi) \\
        z &\in (-\infty, +\infty)
    \end{aligned}
\end{equation}

\begin{itemize}
    \item La coordenada $\rho$ es la distancia del punto al eje $z$.
    \item La coordenada $\varphi$ es el ángulo que forma el vector posición con el eje $x$.
    \item La coordenada $z$ es la distancia del punto al plano $xy$.
\end{itemize}

Los vectores unitarios cilíndricos son $\vv[\rho]{u}, \vv[\varphi]{u}, \vv[z]{u}$. El vector $\vv[\rho]{u}$ es perpendicular a la superficie coordenada $\rho = \text{cte.}$ (que es un cilindro), y apunta en la dirección creciente de $\rho$. El vector $\vv[\varphi]{u}$ es perpendicular a la superficie coordenada $\varphi = \text{cte.}$ (que es un plano perpendicular al eje $z$), y apunta en la dirección creciente de $\varphi$. El vector $\vv[z]{u}$ es perpendicular a la superficie coordenada $z = \text{cte.}$, y apunta en la dirección creciente de $z$.

El vector posición $\vv{r}$ se puede expresar como:
\begin{equation}
    \vv{r} = \rho \vv[\rho]{u} + z \vv[z]{u}
\end{equation}

\subsubsection{Coordenadas esféricas}

Recomendables para problemas con \textbf{simetría esférica}. Los valores que pueden tomar las coordenadas son:
\begin{equation}
    \begin{aligned}
        r &\in [0, +\infty) \\
        \theta &\in [0, \pi] \\
        \varphi &\in [0, 2\pi)
    \end{aligned}
\end{equation}

\begin{itemize}
    \item La coordenada $r$ es la distancia del punto al origen.
    \item La coordenada $\theta$ es el ángulo que forma el vector posición con el eje $z$.
    \item La coordenada $\varphi$ es el ángulo que forma el proyección del vector posición en el plano $xy$ con el eje $x$.
\end{itemize}

Los vectores unitarios esféricos son $\vv[r]{u}, \vv[\theta]{u}, \vv[\varphi]{u}$. El vector $\vv[r]{u}$ es perpendicular a la superficie coordenada $r = \text{cte.}$ (que es una esfera), y apunta en la dirección creciente de $r$. El vector $\vv[\theta]{u}$ es perpendicular a la superficie coordenada $\theta = \text{cte.}$ (que es un cono), y apunta en la dirección creciente de $\theta$. El vector $\vv[\varphi]{u}$ es perpendicular a la superficie coordenada $\varphi = \text{cte.}$ (que es un plano perpendicular al eje $z$), y apunta en la dirección creciente de $\varphi$.

El vector posición $\vv{r}$ se puede expresar como:
\begin{equation}
    \vv{r} = r \vv[r]{u}
\end{equation}

\subsection{Relación entre los sistemas de coordenadas}

\subsubsection{Cartesianas y cilíndricas}

\begin{equation}
    \left\lbrace 
    \begin{aligned}
        x &= \rho \cos \varphi \\
        y &= \rho \sin \varphi \\
        z &= z
    \end{aligned} \right. \qquad \qquad \left\lbrace 
    \begin{aligned}
        \rho &= \sqrt{x^2 + y^2} \\
        \varphi &= \arctan \left( \frac{y}{x} \right) \\
        z &= z
    \end{aligned} \right.
\end{equation}

\subsubsection{Cilíndricas y esféricas}

\begin{equation}
    \left\lbrace 
    \begin{aligned}
        \rho &= r \sin \theta \\
        \varphi &= \varphi \\
        z &= r \cos \theta
    \end{aligned} \right. \qquad \qquad \left\lbrace 
    \begin{aligned}
        r &= \sqrt{\rho^2 + z^2} \\
        \theta &= \arctan \left( \frac{\rho}{z} \right) \\
        \varphi &= \varphi
    \end{aligned} \right.
\end{equation}

\subsubsection{Cartesianas y esféricas}

\begin{equation}
    \left\lbrace 
    \begin{aligned}
        x &= r \sin \theta \cos \varphi \\
        y &= r \sin \theta \sin \varphi \\
        z &= r \cos \theta
    \end{aligned} \right. \qquad \qquad \left\lbrace 
    \begin{aligned}
        r &= \sqrt{x^2 + y^2 + z^2} \\
        \theta &= \arctan \left( \frac{\sqrt{x^2 + y^2}}{z} \right) \\
        \varphi &= \arctan \left( \frac{y}{x} \right)
    \end{aligned} \right.
\end{equation}

\subsection{Operador, campo escalar, campo vectorial}
Un operador es un ``objeto matemático'' que actúa sobre una función, transformándola. Sirve para estudiar las características de esa función.

Un ejemplo sería el operador \textbf{derivada}. Si se aplica el operador derivada a una función.

\begin{equation} \label{eq:ejemplo_operador_derivada}
    \dv{\sen \left( x \right)}{x} = g(x)
\end{equation}

Un campo escalar es una función que asigna un valor escalar a cada punto del espacio. Es decir,

\begin{equation} \label{eq:campo_escalar}
    f(x, y, z) \longrightarrow \mathbb{R} 
\end{equation}


\subsection{Gradiente}

El \textbf{gradiente} es un operador que se aplica a un campo escalar y devuelve un campo vectorial, de tal forma que en cada punto hay un vector que apunta en la dirección de mayor crecimiento del campo escalar. Se denota mediante el operador nabla: $\grad$.

\color{orange}
\begin{align} \label{eq:gradiente}
    \grad f &= \pdv{f}{x} \vv[x]{u} + \pdv{f}{y} \vv[y]{u} + \pdv{f}{z} \vv[z]{u}\\
    \grad f &= \pdv{f}{r} \vv[r]{u} + \frac{1}{r} \pdv{f}{\varphi} \vv[\varphi]{u} + \pdv{f}{z} \vv[z]{u} \\
    \grad f &= \pdv{f}{r} \vv[r]{u} + \frac{1}{r} \pdv{f}{\theta} \vv[\theta]{u} + \frac{1}{r \sin \theta} \pdv{f}{\varphi} \vv[\varphi]{u}
\end{align}
\color{black}

\subsubsection{Ejemplo}

\begin{align*}
    f \left( x,y,z \right) &= 3x^2 + y - \cos (z) \\
    \grad f &= \pdv{f}{x} \vv[x]{u} + \pdv{f}{y} \vv[y]{u} + \pdv{f}{z} \vv[z]{u} \\
     &= 6x \vv[x]{u} + \vv[y]{u} + \sin (z) \vv[z]{u}\\[10pt]
    f \left( 1,1,\frac{\pi}{6} \right) &= 3 + 1 - \frac{\sqrt{3}}{2} = \frac{7-\sqrt{3}}{2}\\
    \grad f \left( 1,1,\frac{\pi}{6} \right) &= 6 \vv[x]{u} + \vv[y]{u} + \frac{1}{2} \vv[z]{u}
\end{align*}

\subsection{Divergencia}
El \textbf{operador divergencia} se aplica a un campo vectorial y devuelve un campo escalar. Se denota también mediante el operador nabla ($\grad$, aunque en \LaTeX el comando \verb|\div| lo asigna como $\div$ porque utiliza el producto escalar entre el operador gradiente y el campo vectorial. Se define como:

\begin{equation} \label{eq:divergencia}
    \div \vv{a} = \text{div} \, \vv{a} = \lim _{V\to 0} \frac{1}{V} \oiint _S \vv{a} \cdot \dd{\vv{S}}
\end{equation}

Si la divergencia es positiva ($\div \vv{a} > 0$), el campo vectorial diverge o emana del punto (fuente). Si la divergencia es negativa ($\div \vv{a} < 0$), el campo vectorial converge o se dirige al punto (sumidero).

En lo diferentes sistemas de coordenadas, se puede calcular como:

\color{orange}
\begin{align}
    a
\end{align}
\color{black}



\subsubsection{Teorema de Gauss o de la divergencia}

La superficie puede ser cualquier superficie cerrada, no necesariamente una esfera.

\begin{equation} \label{eq:teorema_gauss}
    \iiint _V \grad \vv{a} \dd{V} = \oiint _S \vv{a} \cdot \dd{\vv{S}}
\end{equation}

El flujo de un campo vectorial $\vv{a}$ a través de una superficie cerrada equivale a la integral del volumen de la divergencia de $\vv{a}$.

\subsection{Rotacional}

El rotacional se aplica a un campo vectorial y devuelve un campo vectorial. Se representa también por el operador nabla ($\grad$), aunque en \LaTeX el comando \verb|\curl| lo asigna como $\curl$. 


TODO: Calcular el rotacional de $\vv{a} = y \vv[x]{u} - x \vv[y]{u}$. Comprobar que el resultado es un campo vectorial que apunta en la dirección del eje $z$.

En los diferentes sistemas de coordenadas, se puede calcular como:
\color{orange}
\begin{align}
    % Cartesianas
    \curl \vv{a} &= \left( \pdv{a_z}{y} - \pdv{a_y}{z} \right) \vv[x]{u} + \left( \pdv{a_x}{z} - \pdv{a_z}{x} \right) \vv[y]{u} + \left( \pdv{a_y}{x} - \pdv{a_x}{y} \right) \vv[z]{u} \\
    % Cilíndricas
    \curl \vv{a} &= \frac{1}{\rho} \left( \pdv{a_z}{\rho} - \pdv{a_\rho}{z} \right) \vv[\rho]{u} + \frac{1}{\rho} \left( \pdv{a_\rho}{z} - \pdv{a_z}{\rho} \right) \vv[\varphi]{u} + \pdv{a_\varphi}{\rho} \vv[z]{u} \\
    % Esféricas
    \begin{split}
        \curl \vv{a} &= \frac{1}{r \sin \theta} \left( \pdv{a_\varphi}{\theta} - \pdv{a_\theta}{\varphi} \right) \vv[r]{u} + \frac{1}{r} \left( \frac{1}{\sin \theta} \pdv{a_r}{\varphi} - \pdv{a_\varphi}{r} \right) \vv[\theta]{u}\\    &+ \frac{1}{r} \left( \pdv{a_r}{\theta} - \pdv{a_\theta}{r} \right) \vv[\varphi]{u}
    \end{split}
\end{align}
\color{black}

Un campo es \textbf{irrotacional} si su rotacional es nulo.
    \begin{equation} \label{eq:campo_irrotacional}
        \curl \vv{a} = 0
    \end{equation}

La condición necesaria para que un campo vectorial $\vv{a}$ pueda expresarse como el gradiente de un campo escalar $\phi$ es que su rotacional sea nulo. 
    
    \begin{equation} \label{eq:funcion_potencial}
        \curl \vv{a} = 0 \quad \Longleftrightarrow \quad \vv{a} = \grad \phi
    \end{equation} 

\subsection{Teorema de Stokes}

Se escoge una curva cerrada $C$ y una superficie $S$ de forma arbitraria que contenga en su contorno la curva $C$. Entonces, se cumple que el flujo del vector rotacional de un campo vectorial $\vv{a}$ a través de la superficie $S$ es igual a la circulación de $\vv{a}$ a lo largo de la curva $C$.

\begin{equation} \label{eq:teorema_stokes}
    \color{orange}
    \iint _S \left( \curl \vv{a} \right) \cdot \dd{\vv{S}} = \oint _C \vv{a} \cdot \dd{\vv{r}}
\end{equation}

Para campos conservativos, el flujo del rotacional a través de una superficie cerrada es nulo. Por ello, este teorema puede ser útil para resolver 

TODO: Pág 75 de de las transparencias, y el 7 de las tareas de clase.

\subsection{Laplaciano}

El \textbf{operador laplaciano} se aplica a un campo escalar y devuelve un campo escalar. Se denota mediante el operador nabla ($\grad ^2$), aunque en \LaTeX el comando \verb|\laplacian| lo asigna como $\laplacian$ o a veces incluso como un triángulo ($\Delta$).

\begin{equation} \label{eq:laplaciano}
    \Delta f = \laplacian f = \div \left( \grad f \right)
\end{equation}

En coordenadas cartesianas, cilíndricas y esféricas, se puede calcular como:

\color{orange}
\begin{align}
    % Cartesianas
    \laplacian f &= \pdv[2]{f}{x} + \pdv[2]{f}{y} + \pdv[2]{f}{z} \\
    % Cilíndricas
    \laplacian f &= \frac{1}{\rho} \pdv{\rho} \left( \rho \pdv{f}{\rho} \right) + \frac{1}{\rho^2} \pdv[2]{f}{\varphi} + \pdv[2]{f}{z} \\
    % Esféricas
    \laplacian f &= \frac{1}{r^2} \pdv{r} \left( r^2 \pdv{f}{r} \right) + \frac{1}{r^2 \sin \theta} \pdv{\theta} \left( \sin \theta \pdv{f}{\theta} \right) + \frac{1}{r^2 \sin^2 \theta} \pdv[2]{f}{\varphi}
\end{align}
\color{black}

Las ecuaciones de onda están escritas en función de laplacianos, por ello son relevantes.

\subsection{Cálculo de la función potencial}

Lo realizaremos con un ejemplo. Dado el campo vectorial:
\[ \vv{a} = y \vv[x]{u} + \left( 2yz + x \right) \vv[y]{u} + y^2 \vv[z]{u} \]
Y sabiendo que se trata del gradiente de un campo escalar, calcular su función potencial $\phi$.

\[
\begin{split}
    \left. \begin{aligned}
        \grad \phi &= \pdv{\phi}{x} \vv[x]{u} + \pdv{\phi}{y} \vv[y]{u} + \pdv{\phi}{z} \vv[z]{u} \\
        &= a_x \vv[x]{u} + a_y \vv[y]{u} + a_z \vv[z]{u}
    \end{aligned}
     \right\rbrace \Rightarrow
     \left\lbrace \begin{aligned}
        \pdv{\phi}{x} &= y \\
        \pdv{\phi}{y} &= 2yz + x \\
        \pdv{\phi}{z} &= y^2
     \end{aligned} \right. \dots \\
     \Rightarrow
        \left\lbrace \begin{aligned}
            \phi &= \int y \dd{x} &= xy + f_1(y,z) \\
            \phi &= \int \left( 2yz + x \right) \dd{y} &= 2y^2z + xy + f_2(x,z) \\
            \phi &= \int y^2 \dd{z} &= y^2z + f_3(x,y)
        \end{aligned} \right.
\end{split}
\]

TODO: Problema 5 de las tareas de clase

\subsection{Campo solenoidal}

Un campo vectorial es \textbf{solenoidal} si su divergencia es nula. Es decir:
\begin{equation} \label{eq:campo_solenoidal}
    \div \vv{a} = 0
\end{equation}

Si un campo es solenoidal, este se puede expresar como el rotacional de otro campo vectorial, al que se le llama \textbf{potencial vector}.

\begin{equation} \label{eq:potencial_vector}
    \div \vv{a} = 0 \quad \Longleftrightarrow \quad \vv{a} = \curl \vv{A}
\end{equation}

TODO: Comprobar cálculo de la función potencial
TODO: Problemas 6 y 11 de las tareas de clase.
TODO: Comprobar que los ejercicios anteriores están bien (ver fotos)

\section{Ondas acústicas planas}    
\section{Ondas acústicas esféricas}
\section{Reflexión y refracción de ondas acústicas}
\section{Ecuaciones de Maxwell. Ecuaciones de onda. Energía}
\section{Propagación de ondas electromagnéticas en medios dieléctricos}
\section{Propagación de ondas electromagnéticas en medios conductores}
\section{Reflexión y refracción de ondas electromagnéticas}
\section{Ondas guiadas}

\end{document}